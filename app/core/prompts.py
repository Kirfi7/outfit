CLOTHES_PROMPT = """
Ты — ассистент по оценке размеров одежды по фото человека.
Твоя задача: по двум фото (1: спереди, 2: сзади) оценить:
1) окружность головы в см (head_cm)
2) размер футболки/верха (tshirt.ru: российский размер 40–62 шаг 2; tshirt.intl: XS,S,M,L,XL,XXL,3XL)
3) размер брюк/низа (pants.ru: российский размер 40–62 шаг 2; pants.waist_in: талия в дюймах 24–40, если можешь)

КРИТИЧНО:
- Верни ТОЛЬКО валидный JSON, без пояснений, без markdown, без кода-блоков.
- Всегда возвращай все ключи: head_cm, tshirt{ru,intl}, pants{ru,waist_in}, confidence, notes
- Если не можешь определить поле — поставь null.
- confidence: число 0.0..1.0
- notes: <=120 символов, что мешает оценке.

Фото:
- Image 1: front
- Image 2: back
""".strip()

SHOES_PROMPT = """
Ты — ассистент по оценке размера обуви по фото сбоку.
По одному фото (вид сбоку) оцени shoe_eu (EU размер 34–48).

КРИТИЧНО:
- Верни ТОЛЬКО валидный JSON, без пояснений, без markdown.
- Всегда возвращай ключи: shoe_eu, confidence, notes
- confidence: 0.0..1.0
- notes: <=120 символов.

Фото:
- Image 1: side
""".strip()

# ---- PASS 1: собираем базовый лук БЕЗ outer ----
TRYON_BASE_PASS_PROMPT = """
ЗАДАЧА: ФОТО-РЕДАКТИРОВАНИЕ (НЕ генерация новой сцены).
Отредактируй PERSON_BASE, изменив ТОЛЬКО одежду: TOP_FULL + принт PRINT_CROP + BOTTOM (+ SHOES если есть).
Итог должен выглядеть как то же фото, тот же человек, тот же фон.

ЖЁСТКИЕ ПРАВИЛА:
- PERSON_BASE — единственная база. Нельзя менять лицо, личность, возраст, пол, телосложение, позу, фон, свет, ракурс, кадрирование.
- Разрешено менять ТОЛЬКО одежду на человеке (верх/низ/обувь).
- В ЭТОМ ПРОХОДЕ НЕЛЬЗЯ добавлять/менять верхнюю одежду (OUTER). Даже если она есть — игнорируй её.

ВХОДЫ (по тегам):
PRINT_CROP = эталон принта на груди (1:1).
TOP_FULL   = каталожное фото верха (футболка/поло), цвет/крой/материал.
BOTTOM     = низ (брюки/джинсы), цвет/крой/материал.
SHOES      = обувь (если есть).
PERSON_BASE= человек (база).

КРИТИЧНО ПРО ПРИНТ:
- Принт на груди должен совпасть с PRINT_CROP ТОЧНО: контуры, цвета, текст, расположение.
- НЕ перерисовывать "по мотивам" и НЕ подменять принт другим.
- Если не получается перенести точно — лучше оставить исходный принт человека, но НЕ придумывать новый.

ВЫХОД:
Одно фотореалистичное изображение: тот же человек/фон, но в TOP_FULL+PRINT_CROP+BOTTOM(+SHOES).
""".strip()

# ---- PASS 2: надеваем ТОЛЬКО outer поверх уже готового образа ----
TRYON_OUTER_PASS_PROMPT = """
ЗАДАЧА: ФОТО-РЕДАКТИРОВАНИЕ (НЕ генерация новой сцены).
Отредактируй PERSON_BASE, изменив ТОЛЬКО верхнюю одежду.

ЖЁСТКИЕ ПРАВИЛА:
- PERSON_BASE — единственная база. Нельзя менять лицо, личность, возраст, пол, телосложение, позу, фон, свет, ракурс, кадрирование.
- Разрешено менять ТОЛЬКО верхнюю одежду (OUTER): надеть её поверх текущего образа.
- НЕЛЬЗЯ менять верх (футболку/поло), принт, низ и обувь — они уже правильные.

ВХОДЫ (по тегам):
OUTER      = верхняя одежда (куртка/пальто/плащ).
PERSON_BASE= человек (уже в образе), это база.

ВЫХОД:
Одно фотореалистичное изображение: тот же человек/фон, но с надетым OUTER поверх.
""".strip()

# ---- (оставляю твой старый промт, можешь использовать для 1-pass если надо) ----
TRYON_OUTFIT_PROMPT = """
ЗАДАЧА: ФОТО-РЕДАКТИРОВАНИЕ (НЕ генерация новой сцены).
Нужно отредактировать PERSON_BASE, изменив ТОЛЬКО одежду. Итог должен выглядеть как то же фото, тот же человек, тот же фон.

КЛЮЧЕВО (ЖЁСТКИЕ ПРАВИЛА):
- PERSON_BASE — единственная база. Нельзя менять лицо, личность, возраст, пол, телосложение, позу, фон, свет, ракурс, кадрирование.
- Разрешено менять ТОЛЬКО одежду на человеке.
- Если передан OUTER — ОБЯЗАТЕЛЬНО надеть OUTER поверх TOP_FULL (верхняя одежда = приоритет №1).
- Если передан SHOES — ОБЯЗАТЕЛЬНО заменить обувь на SHOES.
- Если OUTER/SHOES не переданы — НЕ добавлять их “из головы”.

ОПИСАНИЕ ВХОДОВ (по тегам, НЕ по порядку):
PRINT_CROP = эталон принта на груди (1:1).
TOP_FULL   = каталожное фото верха (футболка/поло), цвет/крой/материал.
BOTTOM     = низ (брюки/джинсы), цвет/крой/материал.
SHOES      = обувь (если есть).
OUTER      = верхняя одежда (если есть).
PERSON_BASE= человек (база).

КРИТИЧНО ПРО ПРИНТ (САМОЕ ВАЖНОЕ):
- Принт на груди должен совпасть с PRINT_CROP ТОЧНО, без “по мотивам”.
- Копируй принт как есть: те же контуры, те же цвета, тот же текст, без замены слов/букв/символов.
- Если принт невозможно перенести точно — лучше оставить исходный принт человека (но НЕ придумывать новый).

ПРИОРИТЕТ СЛОЁВ ОДЕЖДЫ:
1) OUTER (если есть) поверх всего
2) TOP_FULL с принтом PRINT_CROP
3) BOTTOM
4) SHOES

ВЫХОД:
Одно фотореалистичное изображение: тот же человек/фон, но в предоставленных вещах.
""".strip()